@(fuzzySystem : FuzzySystem, rb : models.RuleBase)

<table border="1">


    <thead>
           <tr>
				<th>Degree</th>
				<th>  </th>

				<!-- Inputs -->  
	                @for(vinput <- rb.inputvars ){
						<th>@vinput.name</th>
						<th>  </th>
	             	}

				<!-- Outputs -->    
	                @for(voutput <- rb.outputvars ){
						<th>@voutput.name</th>
	             	}
                <th>Actions</th>  
           </tr>
    </thead>

    <tbody>
        @for(rule <- forms.RuleTableForm.getInfoMapForTableRule(fuzzySystem,rb.id)){
            <tr>
                <td>
                    @rule.get("degree")(0)
                </td>   

                <td>if</td>


                <!-- Inputs -->    
                @for(i <- 0 to rule.get("inputs").length -1){
                    <td>
                        @rule.get("inputs")(i)
                    </td>
                    @if(i != rule.get("inputs").length -1){
                        <td>&</td>
                    }
                }


                <td>-></td>


                <!-- Outputs -->    

                @for(output <- rule.get("outputs")){
                    <td>
                        @output
                    </td>
                }
                    <td>
                        @forms_util.actions_icons("#",
                            routes.RuleBases.deleteRule(fuzzySystem.id,rb.id,
                                java.lang.Integer.valueOf(rule.get("id")(0))
                            ).toString()
                        )
                    </td>


           </tr>    
        }
    </tbody>

</table>
<input id="new_rule" type="button" class="btn secondary" value="New Rule" />	


<div id="rule-dialog-modal" title="New Rule">
    <form id="rule-dl-form">

		<table border="1">
		    <thead>
		           <tr>
						<th>Degree</th>
						<th>  </th>

						<!-- Inputs -->  
			                @for(vinput <- rb.inputvars ){
								<th>@vinput.name</th>
								<th>  </th>
			             	}

						<!-- Outputs -->    
			                @for(voutput <- rb.outputvars ){
								<th>@voutput.name</th>
			             	}
		           </tr>
		    </thead>

		    <tbody>
		        <tr>
					<td>						
    		        	<input type="text" id="rule_degree" name="degree" value="" >
					</td>	

					<td>if</td>


					<!-- Inputs -->    

		                @for(i <- 0 to rb.inputvars.length -1){
							<td>

		    					<select id="rule_input__@{i}__" name="inputs[@i]" >
    								<option value="" ></option>
		    			            @for( id_mf <- 0 to rb.inputvars(i).getType(fuzzySystem).MFs.length-1 ) {
		    						
		    								<option value="@id_mf" >
		    									@rb.inputvars(i).name 
		    									== 
		    									@rb.inputvars(i).getType(fuzzySystem).MFs(id_mf).label
		    								</option>
		    		                        
		    			             }
		    					</select>
							</td>
							@if(i != rb.inputvars.length -1){
								<td>&</td>

							}else{
								<td> -> </td>
							}
		             	}


					<!-- Outputs -->    

		                @for(i <- 0 to rb.outputvars.length -1){ 
							<td>

		    					<select id="rule_output__@{i}__" name="outputs[@i]" >

    								<option value="" ></option>
		    			            @for( id_mf <- 0 to rb.outputvars(i).getType(fuzzySystem).MFs.length-1 ) {
		    						
		    								<option value="@id_mf" >
		    									@rb.outputvars(i).name 
		    									== 
		    									@rb.outputvars(i).getType(fuzzySystem).MFs(id_mf).label
		    								</option>
		    		                        
		    			             }
		    					</select>
							</td>
		             	}


		       </tr>	
		    </tbody>

		</table>
    </form>
</div>


<script type="text/javascript">

    $(document).ready(function() {

        $( "#rule-dialog-modal" ).dialog({
            width: 'auto',
            autoOpen: false,
            modal: true,
            buttons: {
                Ok: function() {
                    var new_rule_form = $( this ).find("#rule-dl-form");


                    $.post('@routes.RuleBases.ajaxAddRuleFromTable(fuzzySystem.id, rb.id)',
                        new_rule_form.serialize(),
                        function(data) {
                            console.log(data);
                            $("#rule-dialog-modal").dialog( "close" );
                            location.reload();
                        },"json")
                        .error(function(xhr, textStatus, errorThrown) {
                            var errors = JSON.parse(xhr.responseText);

                            // //for each field in the errrors
                            // $.each(errors, function(key, value) { 
                            //    var field = new_var_form.find("[name='" + key + "']");

                            //     //add each error to the given field
                            //     $.each(value, function(index, val){
                            //        field.parent().append("<span class='error'>"+val+"</span></br>");

                            //     });
                            // });

                            console.log(errors); 
                        });
                },
                Cancel: function() {
                    $( this ).dialog( "close" );
                }
            },
            close: function() {                   
                $( this ).dialog( "close" );
                var new_var_form = $( this ).find("#rule-dl-form");

                new_var_form.find("input").val("");
                new_var_form.find("select").val("");                
                new_var_form.find(".error").remove();   
            }
        });

        //change the add buttons to add new vars
        $('#new_rule').click(function(){
            event.preventDefault();
            console.log("new_rule");
            $( "#rule-dialog-modal" ).dialog( "open" );
        });
    });
                
</script>